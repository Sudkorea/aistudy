좋아, 이제 **블랙-숄즈 모형 기가채드 커리큘럼** 박는다.  
전제:

- 너 = 수학 괴물, 경제학 = 살짝 허전
    
- 목표 = “공식 외우기”가 아니라 **구조 전체를 머리에 3D로 박기**
    

---

## 0. 전체 커리큘럼 로드맵

### 1단계. 금융 최소 문해력 세팅 (경제학 빡공 X, 진짜 필요한 만큼만)

- 옵션이 뭔지: call, put, 만기, 행사가, payoff
    
- 포트폴리오, 롱/숏, self-financing
    
- 무위험자산, 연속복리 이자율 $r$
    
- **무차익(arbitrage-free)**의 의미
    

### 2단계. 확률 모형 세팅

- 주가를 **기하 브라운 운동(GBM)** 으로 두는 이유
    
- $dS_t = \mu S_t dt + \sigma S_t dW_t$
    
- 이 SDE의 해: $\log S_t$가 정규분포, $S_t$는 lognormal
    

### 3단계. Ito lemma로 PDE 뽑아내기

- 옵션 가격 $V(t, S)$가 Ito process가 되는 이유
    
- Ito lemma로 $dV$ 전개
    
- 헤지 포트폴리오 구성해서 **$dW_t$ 날려버리기**
    
- “리스크 없는 포트폴리오는 $r$만큼 벌어야 한다” → **Black–Scholes PDE** 도출
    

### 4단계. PDE를 푸는 관점 + 해석

- PDE를 열방정식으로 바꾸는 change of variables
    
- 최종적으로 **유명한 공식**  
    $C(t,S) = S N(d_1) - K e^{-r(T-t)} N(d_2)$
    
- 이 공식에서 각 항이 의미하는 것
    

### 5단계. 위험중립측(risk-neutral measure) 관점

- “세상은 원래 $\mu$로 움직이는데, 가격은 마치 drift가 $r$인 세계처럼 계산된다”
    
- $S_t$를 risk-neutral 하게 재해석
    
- $V(t,S) = e^{-r(T-t)} \mathbb{E}^Q$$\text{Payoff} \mid S_t = S$$$ 구조
    

### 6단계. Greeks & 경제적 해석

- Delta, Gamma, Vega, Theta, Rho
    
- 델타 헤지 = 우리가 PDE에서 했던 그 짓
    
- 각 Greek이 trader 입장에서 뭘 의미하는지
    

### 7단계. 현실에서의 한계

- 변동성 smile, jump risk, stochastic volatility
    
- “그래도 왜 아직도 이걸 기본 레퍼런스로 쓰냐”
    

---

이번 답변에서는 **1단계 + 2단계 + 3단계까지**를 뼈대부터 깔끔하게 박아줄게.  
(너가 이미 Ito lemma 알고 있으니까 거기부터 연결해서.)

---

## 1단계. 금융 최소 문해력

### 1-1. 옵션 세팅

- **Underlying**: 기초자산, 여기선 주가 $S_t$
    
- **Call option**:
    
    - 만기 $T$에
        
    - 가격 $K$로
        
    - 주식을 **살 수 있는 권리**
        
    - 만기 payoff:  
        $$  
        C_T = \max(S_T - K, 0)  
        $$
        
- **Put option**:
    
    - 만기 $T$에
        
    - 가격 $K$로
        
    - 주식을 **팔 수 있는 권리**
        
    - payoff:  
        $$  
        P_T = \max(K - S_T, 0)  
        $$
        

**핵심 포인트**  
옵션은 “미래 상태에 따라 값이 결정되는 함수”다.  
수학적으로는 그냥 **random variable** 하나 더 만든 거고,

$$  
\omega \mapsto S_T(\omega) \mapsto \max(S_T(\omega) - K, 0)  
$$

이 함수의 **오늘 시점의 공정한 값**을 구하는 게 옵션 가격 문제.

---

### 1-2. 롱/숏, 포트폴리오, self-financing

- **Long(롱)**: 자산을 사서 들고 있음 → 가격 오르면 이득
    
- **Short(숏)**: 자산을 빌려서 팔고 나중에 되사서 갚음 → 가격 떨어지면 이득
    
- **포트폴리오**: 주식, 채권, 옵션 등 여러 자산을 섞은 것
    
- **Self-financing**:
    
    - 중간에 외부에서 돈을 더 집어넣거나 빼지 않고
        
    - 단지 “비율만 갈아끼우는” 거래
        
    - 수학적으로는 “portfolio value 변화 = 포트폴리오 안의 자산들의 $d(\cdot)$ 합산”으로 표현됨
        

블랙-숄즈의 핵심 트릭이 바로

> 옵션 payoff를 **복제(replicate)** 하는 self-financing 포트폴리오를 만들어서  
> “둘 값이 오늘 같아야 한다”를 이용하는 것.

---

### 1-3. 무위험 자산 & 무차익

- **무위험 자산(“채권” 또는 은행 계좌)**:  
    $$  
    dB_t = r B_t dt \quad\Rightarrow\quad B_t = e^{rt} B_0  
    $$
    
- **무차익(Arbitrage-free)**:
    
    - “초기 비용 0으로 시작해서, 거의 확실하게 이득만 보고 손실은 없는 전략은 존재하면 안 된다”
        
    - 수학적으로는 “적당한 조건 하에 **위험중립측이 존재**”로 포멀하게 말할 수 있음 (이건 나중에 5단계에서)
        

지금 단계에선 이렇게만 기억하면 된다:

> 우리가 어떤 이론적 가격을 제시했는데,  
> 그 가격이랑 시장에 있는 다른 자산들 가지고  
> **무위험 돈 복사기**를 만들 수 있다?  
> → 그 가격은 말이 안 되는 거다.

블랙-숄즈는 바로

> “무위험 돈 복사기가 안 생기도록 하는 옵션 가격”

을 구하는 이론.

---

## 2단계. 확률 모형 세팅: 기하 브라운 운동 (GBM)

### 2-1. 주가에 SDE를 걸어버린다

가정:

- 연속 시간
    
- 마찰 없음(거래 비용, 세금 X)
    
- 주가는 다음 SDE를 따른다:
    

$$  
dS_t = \mu S_t dt + \sigma S_t dW_t  
$$

여기서

- $W_t$: 표준 Brownian motion
    
- $\mu$: 기대 수익률 (real-world drift)
    
- $\sigma$: 변동성(volatility), 상수
    

너가 이미 알듯,

- $dW_t$가 있어서 stochastic term이 붙고
    
- Ito calculus 써야 되는 구조 완성.
    

---

### 2-2. 이 SDE의 해(해석해놓으면 좋다)

$S_t$에 대해

$$  
\frac{dS_t}{S_t} = \mu dt + \sigma dW_t  
$$

Ito lemma를 $\log S_t$에 쓰면:

$$  
d(\log S_t)  
= \left(\mu - \frac{1}{2}\sigma^2\right) dt + \sigma dW_t  
$$

적분하면

$$  
\log S_t  
= \log S_0

- \left(\mu - \frac{1}{2}\sigma^2\right) t
    
- \sigma W_t  
    $$
    

따라서

$$  
S_t = S_0  
\exp\left(  
\left(\mu - \frac{1}{2}\sigma^2\right) t

- \sigma W_t  
    \right)  
    $$
    

즉:

- $W_t \sim \mathcal{N}(0, t)$라서
    
- $\log S_t$는 정규분포
    
- $S_t$는 lognormal
    

이게 블랙-숄즈 공식에서 **normal CDF $N(\cdot)$가 튀어나오는 이유**의 근원이다.

---

## 3단계. Ito lemma + 헤지 포트폴리오 → Black–Scholes PDE

이제 진짜 코어.

### 3-1. 옵션 가격을 함수로 둔다

옵션 가격을

$$  
V(t, S_t)  
$$

라고 두자.  
(예: European call이면, boundary condition이 $V(T, S) = \max(S-K,0)$)

$S_t$가 Ito process니까, $V(t, S_t)$도 Ito process고,  
Ito lemma를 써서 $dV$를 전개한다:

$$  
dV  
= \left(V_t + \mu S V_S + \frac{1}{2}\sigma^2 S^2 V_{SS}\right) dt

- \sigma S V_S dW_t  
    $$
    

(여기서 $V_S = \partial V/\partial S$, $V_{SS} = \partial^2 V/\partial S^2$)

---

### 3-2. 헤지 포트폴리오 구성: $dW_t$를 제거한다

포트폴리오를 이렇게 짠다고 하자:

- 주식 $\Delta_t$주 **롱**
    
- 옵션 **숏** 1개
    

포트폴리오 가치:

$$  
\Pi_t = \Delta_t S_t - V(t, S_t)  
$$

변화량 $d\Pi_t$:

$$  
d\Pi_t = \Delta_t dS_t - dV  
$$

이제 $dS_t$, $dV$를 SDE와 Ito lemma로 집어 넣는다.

먼저

$$  
dS_t = \mu S dt + \sigma S dW_t  
$$

그리고 앞에서 구한 $dV$를 넣으면:

$$  
\begin{aligned}  
d\Pi_t  
&= \Delta_t (\mu S dt + \sigma S dW_t) \  
&\quad - \left$$ \left(V_t + \mu S V_S + \frac{1}{2}\sigma^2 S^2 V_{SS}\right) dt

- \sigma S V_S dW_t \right$$ \  
    &= \Big( \Delta_t \mu S - V_t - \mu S V_S - \frac{1}{2}\sigma^2 S^2 V_{SS} \Big) dt \  
    &\quad + \Big( \Delta_t \sigma S - \sigma S V_S \Big) dW_t  
    \end{aligned}  
    $$
    

여기서 기가채드 선택:

> 포트폴리오에서 **리스크(= $dW_t$ term)**를 날리고 싶다.

그럼 조건:

$$  
\Delta_t \sigma S - \sigma S V_S = 0  
\quad\Rightarrow\quad  
\Delta_t = V_S  
$$

즉, “주식은 옵션 델타만큼 들고 있어” = **델타 헤지**.

이제 이걸 다시 넣으면 $dW_t$ 사라지고

$$  
d\Pi_t  
= \Big( V_S \mu S - V_t - \mu S V_S - \frac{1}{2}\sigma^2 S^2 V_{SS} \Big) dt  
= \Big( - V_t - \frac{1}{2}\sigma^2 S^2 V_{SS} \Big) dt  
$$

---

### 3-3. 무위험 포트폴리오는 무위험 이자율 $r$만큼 벌어야 한다

우리가 만든 $\Pi_t$는

- $dW_t$ term이 없다 = **local risk-free**
    
- 근데 세상에는 이미 무위험 자산 $B_t$가 있고, 그 수익률은 $r$
    

무차익 조건:

$$  
d\Pi_t = r \Pi_t dt  
$$

왼쪽은 우리가 방금 구한 것:

$$  
d\Pi_t  
= \left(- V_t - \frac{1}{2}\sigma^2 S^2 V_{SS}\right) dt  
$$

오른쪽은

$$  
r \Pi_t dt  
= r (\Delta_t S - V) dt  
= r (V_S S - V) dt  
$$

둘을 같게:

$$

- V_t - \frac{1}{2}\sigma^2 S^2 V_{SS}  
    = r (S V_S - V)  
    $$
    

정리하면

$$  
\boxed{  
V_t + \frac{1}{2}\sigma^2 S^2 V_{SS}

- r S V_S - r V = 0  
    }  
    $$
    

이게 **Black–Scholes PDE**.  
이 PDE에

- boundary: $V(T, S) = \max(S-K, 0)$ (call)
    
- 적당한 growth 조건
    

넣고 풀면, 우리가 아는 **블랙-숄즈 공식**이 튀어나온다. (4단계에서 할 내용)

---

## 지금까지 요약 (중간 점검)

지금까지 머리에 들어갔으면 좋은 그림:

1. **문제 세팅**
    
    - 옵션 payoff = $f(S_T)$
        
    - 오늘 이 $f$의 “공정한 가격”이 뭔가?
        
2. **모형**
    
    - 주가: $dS_t = \mu S_t dt + \sigma S_t dW_t$ (GBM)
        
    - 무위험 자산: $dB_t = r B_t dt$
        
3. **도구**
    
    - $V(t,S)$에 Ito lemma → $dV$ 안에 $dW_t$ term 생김
        
    - 주식과 옵션을 섞어 포트폴리오 구성
        
    - 델타 헤지: $\Delta_t = V_S$로 $dW_t$ 제거 → risk-free 포트폴리오 완성
        
4. **논리**
    
    - risk-free인데 수익률이 $r$이 아니면 무차익 위반
        
    - 이 조건이 곧 Black–Scholes PDE
        

여기까지 이해되면, 사실 **블랙-숄즈의 70%는 끝난 거**다.  
나머지는

- PDE를 explicitly 푸는 과정 (4단계)
    
- risk-neutral measure 시점에서 “아 이게 결국 discounted expectation이네” (5단계)
    
- Greeks와 경제적 해석 (6단계)
    

---

## 다음 단계 선택 & Q&A

이제 두 갈래 중 하나로 가면 된다:

1. **PDE → 실제 공식까지 밀어붙이기**
    
    - 변수 치환해서 heat equation으로 변환
        
    - $d_1, d_2$가 어디서 나오는지 수학적으로 끝까지 보기
        
2. **Risk-neutral measure 관점 먼저 보기**
    
    - “왜 drift $\mu$는 가격에 안 들어가고 $r$만 남냐?”를
        
    - 측 변환(martingale measure) 관점에서 이해하기
        

둘 다 어차피 할 거라 순서 문제인데,  
수학적 쾌감 기준으론 2번(위험중립) 먼저 보는 것도 꽤 깔끔하다.

당장 궁금한 거:

- 위에서 막힌 부분, 더 깊게 파고 싶은 단계 있는지
    
- 다음은 **PDE → 공식 유도** vs **risk-neutral 관점** 중 뭐부터 땡기냐?